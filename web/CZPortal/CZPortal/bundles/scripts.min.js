"use strict";!function(){function e(e,t,a){function r(e,t){return{request:function(e){var a=screen.width,r=screen.height,o=t.path();return setTimeout(function(){o.indexOf("main")>-1&&($(".section").css({height:r/2+"px",width:a/2+"px"}),$(".section-main").css({height:r+"px",width:a+"px"}),$(".section-center").css({height:r/2+"px",width:a+"px"}),$(".section h1").css({"line-height":"2rem"}),$(".chart-idc-use").css({height:"66%"}),$(".idcuse-desc p").css({"font-size":"0.9rem"}),$(".idcuse-desc p strong").css({"font-size":"1rem"})),(o.indexOf("dept")>-1||o.indexOf("standard")>-1||o.indexOf("support")>-1||o.indexOf("datamap")>-1||o.indexOf("idcuse")>-1||o.indexOf("bigdata")>-1)&&($(".section").css({height:r+"px",width:a+"px"}),$("body").css({overflow:"hidden"})),o.indexOf("dashboard")>-1&&($("html").css({"font-size":"16px"}),$("#dashboard").css({height:r+"px",width:a+"px"}),$(".section").css({height:r/2+"px",width:a/4+"px"}),$(".section-center").css({height:r/2+"px",width:a/2+"px"}),$(".section.city-datamap").css({position:"absolute",top:r/2+"px",left:a/4+"px"}),$(".section.idcuse").css({position:"absolute",top:r/2+"px",right:a/4+"px"}),$(".section.bigdata").css({position:"absolute",top:r/2+"px",left:0}),$(".section.standard").css({position:"absolute",top:r/2+"px",right:0}))},500),e},response:function(t){return e.when(t,function(e){}),t}}}t.otherwise("/dashboard"),e.state("dashboard",{url:"/dashboard",templateUrl:"partials/dashboard/view.html",controller:"dashboardController",controllerAs:"dashboard"}).state("standard",{url:"/standard",templateUrl:"partials/standard/view.html",controller:"dashboardController",controllerAs:"dashboard"}).state("center",{url:"/center",templateUrl:"partials/center/view.html",controller:"dashboardController",controllerAs:"dashboard"}).state("main",{url:"/main",templateUrl:"partials/main/view.html",controller:"dashboardController",controllerAs:"dashboard"}).state("bigdata",{url:"/bigdata",templateUrl:"partials/bigdata/view.html",controller:"dashboardController",controllerAs:"dashboard"}).state("support",{url:"/support",templateUrl:"partials/support/view.html",controller:"dashboardController",controllerAs:"dashboard"}).state("datamap",{url:"/datamap",templateUrl:"partials/datamap/view.html",controller:"dashboardController",controllerAs:"dashboard"}).state("idcuse",{url:"/idcuse",templateUrl:"partials/idcuse/view.html",controller:"dashboardController",controllerAs:"dashboard"}).state("dept",{url:"/dept",templateUrl:"partials/dept/view.html",controller:"dashboardController",controllerAs:"dashboard"}),a.interceptors.push(r),r.$inject=["$q","$location"]}angular.module("app",["ngAnimate","ui.router","common.http","app.dashboard"]).config(e),e.$inject=["$stateProvider","$urlRouterProvider","$httpProvider"]}(),function(){var e=angular.module("common.http",[]);e.constant("URL",location.protocol+"//"+location.host+"/BigScreenShow/data"),e.factory("validate",[function(){return function(e,t){var a=function(t){return e&&e.head&&e.head.status===t};switch(t){case 200:return a(t);case 201:return a(t);case 202:return a(t);case 400:return a(t);case 404:return a(t);case 405:return a(t);case 415:return a(t);case 500:return a(t)}}}])}(),function(){var e=angular.module("app.dashboard",[]);e.$inject=["$location"],e.controller("dashboardController",["$scope","dashboardService","$rootScope","$interval","$timeout",function(e,t,a,r,o){function n(){e.CivilServant={};var t=Number(sessionStorage.getItem("all")),a=Number(sessionStorage.getItem("careerPersonnel")),r=Number(sessionStorage.getItem("onTheJob")),o=Number(sessionStorage.getItem("beLate")),n=Number(sessionStorage.getItem("leaveEarly")),i=Number(sessionStorage.getItem("daily")),l=Number(sessionStorage.getItem("weekly")),s=Number(sessionStorage.getItem("quarter"));t?e.CivilServant.all=t:(e.CivilServant.all=Math.round(99*Math.random()+3042),sessionStorage.setItem("all",e.CivilServant.all)),a?e.CivilServant.careerPersonnel=a:(e.CivilServant.careerPersonnel=1e3,sessionStorage.setItem("careerPersonnel",e.CivilServant.careerPersonnel)),r?e.CivilServant.onTheJob=r:(e.CivilServant.onTheJob=0+e.CivilServant.all+e.CivilServant.careerPersonnel-Math.round(20*Math.random()+30),sessionStorage.setItem("onTheJob",e.CivilServant.onTheJob)),o?e.CivilServant.beLate=o:(e.CivilServant.beLate=Math.round(20*Math.random()+30),sessionStorage.setItem("beLate",e.CivilServant.beLate)),n?e.CivilServant.leaveEarly=n:(e.CivilServant.leaveEarly=Math.round(20*Math.random()+30),sessionStorage.setItem("leaveEarly",e.CivilServant.leaveEarly)),i?e.CivilServant.daily=i:(e.CivilServant.daily=0+e.CivilServant.all+e.CivilServant.careerPersonnel-Math.round(20*Math.random()+30),sessionStorage.setItem("daily",e.CivilServant.daily)),l?e.CivilServant.weekly=l:(e.CivilServant.weekly=0+e.CivilServant.all+e.CivilServant.careerPersonnel-Math.round(20*Math.random()+30),sessionStorage.setItem("weekly",e.CivilServant.weekly)),s?e.CivilServant.quarter=s:(e.CivilServant.quarter=0+e.CivilServant.all+e.CivilServant.careerPersonnel-Math.round(200*Math.random()+500),sessionStorage.setItem("quarter",e.CivilServant.quarter))}var i=this;a.change_flag=!1,e.update_day_date=new Date,e.update_date=new Date,o(function(){$("#menu-scroll").slick({slidesToShow:5,slidesToScroll:1,autoplay:!0,autoplaySpeed:3e4,vertical:!0,verticalSwiping:!0}),e.current_tab=1,$("#menu-scroll").on("beforeChange",function(t,a,r,n){e.current_tab=n+1,5==e.current_tab&&o(function(){$(".weather-scroll").slick({slidesToShow:2,slidesToScroll:1,cssEase:"linear",autoplay:!0,centerMode:!0,autoplaySpeed:0,speed:7e3,vertical:!0,verticalSwiping:!0})},1500)})},1e3),e.toggle=function(t){e.current_tab=t,$("#menu-scroll").slick("slickGoTo",t-1)};var l=function(){t.getDataCountLast().then(function(t){e.dataCountLast=t.data.body}),t.getResourceCombing().then(function(t){e.ResourceCombing=t.data.body[0]}),t.getAccessDataNum().then(function(t){e.deptAccessData=t.data.body,e.deptAccessMax=_.max(_.map(e.deptAccessData,"dataNum"))+30,_.forEach(e.deptAccessData,function(t){t.i_width=t.dataNum/e.deptAccessMax*100+"%"}),o(function(){$(".dept-access-rank").slick({slidesToShow:8,slidesToScroll:1,autoplay:!0,autoplaySpeed:2500,vertical:!0,verticalSwiping:!0})},10)})},s=function(){t.getVehicle().then(function(t){var a=t.data.body[0];!e.Vehicle||!e.Vehicle.yesterday||a.yesterday&&""!=a.yesterday&&0!=a.yesterday||(a.yesterday=angular.copy(e.Vehicle.yesterday)),e.Vehicle=a})},c=function(){t.getCivilServant().then(function(e){n()})};r(function(){e.CivilServant.onTheJob=e.CivilServant.all+e.CivilServant.careerPersonnel-Math.round(20*Math.random()+30),sessionStorage.setItem("onTheJob",e.CivilServant.onTheJob),e.CivilServant.beLate=Math.round(20*Math.random()+30),sessionStorage.setItem("beLate",e.CivilServant.beLate),e.CivilServant.leaveEarly=Math.round(20*Math.random()+30),sessionStorage.setItem("leaveEarly",e.CivilServant.leaveEarly),e.CivilServant.daily=e.CivilServant.all+e.CivilServant.careerPersonnel-Math.round(20*Math.random()+30),sessionStorage.setItem("daily",e.CivilServant.daily)},864e5),r(function(){e.CivilServant.weekly=e.CivilServant.all+e.CivilServant.careerPersonnel-Math.round(20*Math.random()+30),sessionStorage.setItem("weekly",e.CivilServant.weekly)},6048e5);var d=function(){t.getGovernmentApprovalSystem().then(function(t){e.GovernmentApprovalSystem=t.data.body[0]})},u=function(){t.getMeteorologicalObservationStation().then(function(t){e.MeteorologicalObservationStation=t.data.body[0]}),t.getMos_maxTemperature().then(function(t){var a=t.data.body[0];a&&void 0!=a.zgqw?(sessionStorage.setItem("zgqw",a.zgqw),sessionStorage.setItem("zgqw_zm",a.zm),sessionStorage.setItem("zgqw_rksj",a.rksj)):(a={},a.zgqw=sessionStorage.getItem("zgqw"),a.zm=sessionStorage.getItem("zgqw_zm"),a.rksj=sessionStorage.getItem("zgqw_rksj")),e.Mos_maxTemperature=a}),t.getMos_minTemperature().then(function(t){var a=t.data.body[0];a&&void 0!=a.zdqw?(sessionStorage.setItem("zdqw",a.zdqw),sessionStorage.setItem("zdqw_zm",a.zm),sessionStorage.setItem("zdqw_rksj",a.rksj)):(a={},a.zdqw=sessionStorage.getItem("zdqw"),a.zm=sessionStorage.getItem("zdqw_zm"),a.rksj=sessionStorage.getItem("zdqw_rksj")),e.Mos_minTemperature=a}),t.getMos_maxRainfall().then(function(t){var a=t.data.body[0];a&&void 0!=a.yxsyl?(sessionStorage.setItem("yxsyl",a.yxsyl),sessionStorage.setItem("yxsyl_zm",a.zm),sessionStorage.setItem("yxsyl_rksj",a.rksj)):(a={},a.yxsyl=sessionStorage.getItem("yxsyl"),a.zm=sessionStorage.getItem("yxsyl_zm"),a.rksj=sessionStorage.getItem("yxsyl_rksj")),e.Mos_maxRainfall=a})},h=function(){e.hide_weather=!1,t.getWeatherForecast().then(function(t){t&&t.data&&t.data.body&&t.data.body[0]?(e.hide_weather=!1,e.WeatherForecast=t.data.body[0]):e.hide_weather=!0}),e.hide_disaster=!1,t.getDisasterWarning().then(function(t){e.DisasterWarning=t.data.body,e.DisasterWarning&&e.DisasterWarning.length>0||(e.hide_disaster=!0)})};e.getTimingData=function(){t.getDisasterWarning().then(function(t){e.DisasterWarning=t.data.body,e.DisasterWarning&&e.DisasterWarning.length>0?(e.hide_disaster=!1,o(function(){$(".weather-scroll").slick({slidesToShow:2,slidesToScroll:1,cssEase:"linear",autoplay:!0,centerMode:!0,autoplaySpeed:0,speed:7e3,vertical:!0,verticalSwiping:!0})},300)):e.hide_disaster=!0})},e.getWeatherData=function(){t.getWeatherForecast().then(function(t){t&&t.data&&t.data.body&&t.data.body[0]?(e.hide_weather=!1,e.WeatherForecast=t.data.body[0]):e.hide_weather=!0})};var p=function(){t.getCreditWebOne().then(function(t){e.CreditWebOne=t.data.body[0]}),t.getCreditWebTwo().then(function(t){e.CreditWebTwo=t.data.body[0]}),t.getCreditWebThree().then(function(t){e.CreditWebThree=t.data.body[0]}),e.entries=[{label:"社保登记",color:"#01ccd1"},{label:"税务登记"},{label:"司法行政登记",color:"#01ccd1"},{label:"事业单位登记"},{label:"企业注册人"},{label:"市场主体退出（注销）"},{label:"市场主体退出（吊销）",color:"#01ccd1"},{label:"事业单位年报"},{label:"机关群团登记"},{label:"诚信企业评价",color:"#01ccd1"},{label:"批评谴责",color:"#01ccd1"},{label:"失信被执行人"},{label:"水电欠费信息"},{label:"司法执行"},{label:"司法判决"},{label:"产品质量监督抽查"},{label:"拖欠公积金"},{label:"表彰奖励"},{label:"中小企业信用等级"},{label:"食品生产经营企业监管等级",color:"#01ccd1"},{label:"纳税信用评级"},{label:"其它行政处理措施",color:"#01ccd1"},{label:"重大税收违法"},{label:"行政奖励"},{label:"行政强制措施"},{label:"工商局行政处罚",color:"#01ccd1"},{label:"行政处罚"},{label:"民政登记",color:"#01ccd1"},{label:"商标"},{label:"专利"},{label:"动产抵押"},{label:"对外贸易经营者备案登记",color:"#01ccd1"},{label:"绿色食品"},{label:"农产品地理标志"},{label:"无公害农产品"},{label:"行业资质资格",color:"#01ccd1"},{label:"行政许可",color:"#01ccd1"},{label:"市场主体退出",color:"#01ccd1"},{label:"股权出质"},{label:"消费者投诉站"},{label:"协会成员单位",color:"#01ccd1"},{label:"机构代码证发放"},{label:"公积金缴存登记"},{label:"市场主体"}];({entries:e.entries,width:900,height:400,radius:"40%",radiusMin:175,bgDraw:!0,bgColor:"transparent",opacityOver:1,opacityOut:.05,opacitySpeed:10,fov:1e3,speed:.2,fontFamily:"Oswald, Arial, sans-serif",fontSize:"18",fontColor:"#fff",fontWeight:"normal",fontStyle:"normal",fontStretch:"normal",fontToUpperCase:!0});o(function(){var e={textFont:"Arial, Helvetica, sans-serif",maxSpeed:.05,minSpeed:.01,textColour:null,textHeight:12,outlineMethod:"colour",fadeIn:800,outlineColour:"#41b1c3",outlineOffset:0,depth:.97,minBrightness:.2,wheelZoom:!1,reverse:!0,shadowBlur:2,shuffleTags:!0,shadowOffset:[1,1],stretchX:1.6,initial:[0,.1],clickToFront:600,maxSpeed:.01,outlineDashSpeed:.5},t=(new Date).getTime()/360;e.initial[0]=.18*Math.cos(t),e.initial[1]=.18*Math.sin(t),$("#myCanvas").tagcanvas(e,"tags")||$("#myCanvasContainer").hide()},600)},g=function(){t.getIndustrialPolicy().then(function(t){e.IndustrialPolicy=t.data.body,_.forEach(e.IndustrialPolicy,function(e,t){t%3==0?e.itemStyle="item-up":t%3==1?e.itemStyle="item-center":e.itemStyle="item-down"}),o(function(){$("#pro-list").slick({slidesToShow:3,slidesToScroll:1,autoplay:!0,autoplaySpeed:3e3,vertical:!0,verticalSwiping:!0})},500)})},m=function(){t.getDeptDataQuantity().then(function(e){var t=e.data.body[0];t&&(i.deptData=t)}),t.getDataCount().then(function(e){var t=e.data.body[0];t&&(i.deptDataCount=t)}),l(),s(),c(),d(),u(),h(),p(),g()};m(),e.toggleDept=function(){if(e.allow_toggle){var t=angular.copy(e.toggleMap);e.toggleMap=(t+1)%3,1==e.toggleMap&&(_.forEach(e.deptAccessData,function(e){e.i_width="0%"}),o(function(){_.forEach(e.deptAccessData,function(t){t.i_width=t.dataNum/e.deptAccessMax*100+"%"}),$(".dept-access-rank").slick("slickGoTo",0)},100))}},e.toggleBigdata=function(){e.allow_ipc_toggle&&(e.toggleIPC?e.toggleIPC=!1:e.toggleIPC=!0)},e.deptToggleClick=function(){e.allow_toggle=!0,e.toggleDept()},e.bigdataToggleClick=function(){e.allow_ipc_toggle=!0,e.toggleBigdata()},e.toggleMap=0,e.toggleIPC=!1,e.deptViewTitle="切换视图",r(function(){},3e4),e.allow_toggle=!0,e.mouseEnter=function(){console.log("mouse enter...."),e.allow_toggle=!1},e.mouseLeave=function(){console.log("mouse leave...."),e.allow_toggle=!0},e.allow_ipc_toggle=!0,e.mouseIPCEnter=function(){e.allow_ipc_toggle=!1},e.mouseIPCLeave=function(){e.allow_ipc_toggle=!0},r(function(){e.update_day_date=new Date},864e5),r(function(){h()},9e5),r(function(){u(),s(),c(),d(),p(),l(),g(),e.update_date=new Date},36e5),e.changeRoute=function(){t.getStatus().then(function(e){var a=e.data,r="";r=1==a?"":1,t.setStatus(r).then(function(){})})}}]),e.run(["$rootScope","$interval","$location","dashboardService",function(e,t,a,r){e.state="";t(function(){var e=a.path();r.getStatus().then(function(t){var r=t.data;1==r&&(e.indexOf("bigdata")>-1&&a.path("/idcuse"),e.indexOf("support")>-1&&a.path("/datamap"),e.indexOf("datamap")>-1&&a.path("/support"),e.indexOf("idcuse")>-1&&a.path("/bigdata"))})},5e3)}]),e.factory("dashboardService",["$http","URL",function(e,t){function a(){return e.get(t+"/depDataInfo/quantity")}function r(){return e.get(t+"/status/get")}function o(){return e.get(t+"/serverMonitor/detail")}function n(){return e.get(t+"/serverMonitor/detailTime")}function i(a){return e.put(t+"/status/set?value="+a)}function l(){return e.get(t+"/depDataInfo/dataInfoNum")}function s(){return e.get(t+"/depDataInfo/dataCountLast")}function c(){return e.get(t+"/combing/ResourceCombing")}function d(){return e.get(t+"/depDataInfo/dataCount")}function u(){return e.get(t+"/depDataInfo/accessDataNum")}function h(){return e.get("assets/file/depts_coord.json")}function p(){return e.get("assets/file/dept_contract.json")}function g(){return e.get(t+"/sixApp/vehicle")}function m(){return e.get(t+"/sixApp/vehicleView")}function v(){return e.get(t+"/sixApp/civilServant")}function f(){return e.get(t+"/sixApp/governmentApprovalSystem")}function b(){return e.get(t+"/sixApp/meteorologicalObservationStation")}function y(){return e.get(t+"/sixApp/mos_maxTemperature")}function S(){return e.get(t+"/sixApp/mos_minTemperature")}function w(){return e.get(t+"/sixApp/mos_maxRainfall")}function x(){return e.get(t+"/sixApp/weatherForecast")}function C(){return e.get(t+"/sixApp/disasterWarning")}function k(){return e.get(t+"/sixApp/creditWebOne")}function z(){return e.get(t+"/sixApp/creditWebTwo")}function D(){return e.get(t+"/sixApp/creditWebThree")}function _(){return e.get(t+"/depDataInfo/industrialPolicy")}return{getDeptDataQuantity:a,getStatus:r,getIdcUse:o,getIdcUseTime:n,setStatus:i,getDataInfoNum:l,getDataCountLast:s,getResourceCombing:c,getDataCount:d,getAccessDataNum:u,getDeptCoords:h,getDeptContract:p,getVehicle:g,getVehicleView:m,getCivilServant:v,getGovernmentApprovalSystem:f,getMeteorologicalObservationStation:b,getMos_maxTemperature:y,getMos_minTemperature:S,getMos_maxRainfall:w,getWeatherForecast:x,getDisasterWarning:C,getCreditWebOne:k,getCreditWebTwo:z,getCreditWebThree:D,getIndustrialPolicy:_}}]),e.service("dashboard.chartDockProgress",["$http","URL",function(e,t){}]),e.service("dashboard.chartDockDataset",["$http","URL",function(e,t){}]),e.service("dashboard.chartDeptDataTable",["$http","URL",function(e,t){return t?e({method:"GET",url:t+"/depDataInfo/table",withCredentials:!0}):void console.error("API Not Found in config.js")}]),e.service("dashboard.chartDeptDataColumn",["$http","URL",function(e,t){return t?e({method:"GET",url:t+"/depDataInfo/column",withCredentials:!0}):void console.error("API Not Found in config.js")}]),e.directive("wiservDockProgress",["dashboard.chartDockProgress",function(e){return{restrict:"ACE",template:"<div id='dockProgress'></div>",link:function(e,t,a){var r=screen.width,o=4;r<2e3&&(o=4),r<1600&&(o=3);var n={title:{text:"对接进度",left:"center",top:15,textStyle:{color:"rgb(0,225,252)",fontSize:8*o,fontWeight:"normal"}},tooltip:{trigger:"axis"},radar:[{indicator:[{text:"市民一卡通系统",max:70},{text:"气象观测系统",max:70,axisLabel:!1},{text:"成都市公共气象服务平台",max:70,axisLabel:!1},{text:"公务员管理系统",max:70,axisLabel:!1},{text:"综合执法智慧服务平台",max:70,axisLabel:!1},{text:"成都市企业信用系统 ",max:70,axisLabel:!1},{text:"成都崇州行政审批系统 ",max:70,axisLabel:!1},{text:"数字化城管系统 ",max:70,axisLabel:!1},{text:"省行权平台 ",max:70,axisLabel:!1}],center:["52%","55%"],radius:50*o,splitNumber:7,name:{formatter:"{value}",textStyle:{color:"rgba(220, 220, 220, 1)",fontSize:4*o}},splitArea:{areaStyle:{color:["transparent"],shadowColor:"rgba(0, 0, 0, 0.3)",shadowBlur:10}},axisLine:{show:!1,lineStyle:{color:"rgba(255, 255, 255, 0.5)"}},splitLine:{lineStyle:{color:"rgba(204, 204, 204, 0.3)"}},axisLabel:{show:!0,formatter:"{value}%",textStyle:{color:"#DDD"}}}],series:[{name:"雷达图",type:"radar",tooltip:{trigger:"item"},itemStyle:{emphasis:{lineStyle:{width:4}}},data:[{value:[60,30,60,10,50,20,68,50,10],name:"对接进度",symbolSize:5,lineStyle:{normal:{color:"rgb(69,128,180)",width:2,shadowColor:"rgb(94,154,208)",shadowOffsetX:0,shadowOffsetY:0,shadowBlur:12}},itemStyle:{normal:{color:"rgb(69,128,180)"}}}]}]},i=echarts.init(t.find("#dockProgress")[0]);setTimeout(function(){var e=t.find("#dockProgress")[0].clientWidth;$("#dockProgress").css({width:e}),i.clear(),i.resize(),i.setOption(n)},1e3)}}}]),e.directive("wiservDockDataset",["dashboard.chartDockDataset",function(e){return{restrict:"ACE",template:"<div id='dockDataset'></div>",link:function(e,t,a){var r=screen.width,o=4;r<2e3&&(o=4),r<1600&&(o=3);var n={title:{text:"对接后采集到平台的数据项",left:"center",top:48,textStyle:{color:"rgb(0,225,252)",fontSize:8*o,fontWeight:"normal"}},color:["#3398DB"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{top:"24%",left:"3%",right:"4%",bottom:"20%",containLabel:!0},xAxis:[{type:"category",data:["市民一卡通系统","省行权平台","数字化城管系统","成都崇州行政审批系统","成都市企业信用系统","综合执法智慧服务平台","公务员管理系统","成都市公共气象服务平台","气象观测系统"],axisTick:{alignWithLabel:!0},axisLabel:{rotate:45,interval:0,textStyle:{color:"rgba(220, 220, 220, 1)",fontSize:4*o}},axisLine:{lineStyle:{color:"rgba(204, 204, 204, 0.5)"}}}],yAxis:[{type:"value",axisTick:{show:!1},axisLine:{show:!1},axisLabel:{textStyle:{color:"rgba(220, 220, 220, 1)",fontSize:3*o}},splitLine:{lineStyle:{color:["rgba(204, 204, 204, 0.5)"]}}}],series:[{name:"采集数据项",type:"bar",barWidth:"45%",label:{normal:{show:!0,position:"top",textStyle:{color:"rgba(240, 240, 240, 1)",fontSize:3*o}}},itemStyle:{normal:{color:"rgb(0,112,192)",shadowColor:"rgb(8, 152, 255)",shadowBlur:8}},data:[16,5,15,4,16,28,18,37,24]}]},i=echarts.init(t.find("#dockDataset")[0]);setTimeout(function(){var e=t.find("#dockDataset")[0].clientWidth;$("#dockDataset").css({width:e}),i.clear(),i.resize(),i.setOption(n)},2e3)}}}]),e.directive("wiservChartMigrate",["dashboardService",function(e){return{restrict:"ACE",template:"<div id='deptData' style='width:100%;height:100%'></div>",link:function(t,a,r){var o=echarts.init(a.find("#deptData")[0]);e.getDeptCoords().then(function(e){function t(e,t,a,r){var o=[];if(r)for(var n=0,i=t.length;n<i;n++)a!=t[n].name&&o.push({coords:[e[a],e[t[n].name]]});else for(var n=0,i=t.length;n<i;n++)a!=t[n].name&&("成都市政务中心"==t[n].name||"成都市气象局"==t[n].name||"成都市工商局"==t[n].name||("成都市政府部门"==t[n].name?o.push({coords:[e[t[n].name],e[a]],lineStyle:{normal:{color:"rgb(103,254,0)"}}}):o.push({coords:[e[t[n].name],e[a]]})));return o}function a(e,t,a){for(var r=[],o=0,n=t.length;o<n;o++){var i=t[o].name;a!=i&&("成都市政府部门"==i?r.push({name:i,value:e[i],symbolSize:16,itemStyle:{normal:{color:"rgb(103,254,0)"}},label:{normal:{position:[-150,-60],textStyle:{color:"#FFF",fontSize:24,fontWeight:100}}}}):"成都市政务中心"==i||"成都市气象局"==i||"成都市工商局"==i?r.push({name:i,value:e[i],symbolSize:.001,label:{normal:{position:d}}}):e[i][0]>91&&e[i][0]<119&&e[i][1]<21?r.push({name:i,value:e[i],symbolSize:6,label:{normal:{position:[-30,22]}},itemStyle:{normal:{color:"rgb(255,241,81)"}}}):e[i][0]<=91?r.push({name:i,value:e[i],symbolSize:6,label:{normal:{position:[-80,-5]}},itemStyle:{normal:{color:"rgb(238,141,9)"}}}):r.push({name:i,value:e[i],symbolSize:6}))}return r.push({name:a,value:e[a],symbolSize:16,label:{normal:{position:[-100,-60],textStyle:{color:"#FFF",fontSize:24,fontWeight:100}}},itemStyle:{normal:{color:"rgb(255,234,1)"}}}),r}var r=e.data.coords,n=e.data.data,i="circle",l=.8,s=["38%","45%"],c=15,d=[60,-5],u=screen.width;screen.height;u<1600&&(l=.6,s=["29%","35%"],c=14,d=[15,-8]);var h={backgroundColor:"transparent",title:{text:"",left:"5",top:"10px",itemStyle:{normal:{borderColor:"rgba(100,149,237,1)",borderWidth:.5,areaStyle:{color:"#1b1b1b"}}}},tooltip:{trigger:"item"},geo:{map:"china",show:!1,zoom:l,layoutCenter:s,layoutSize:"100%",left:"2%",label:{emphasis:{show:!1}},roam:!0,silent:!0,itemStyle:{normal:{areaColor:"transparent",borderColor:"#000"},emphasis:{areaColor:"#2a333d"}}},series:[{type:"lines",zlevel:2,silent:!0,effect:{show:!0,period:6,trailLength:.005,color:"rgba(255,255,255,.8)",symbol:i,symbolSize:4},lineStyle:{normal:{color:"#a6c84c",width:1,opacity:.4,curveness:.2,shadowColor:"rgb(255,241,81)",shadowBlur:10}},data:t(r,n,"崇州市数据共享交换平台",!1)},{type:"effectScatter",coordinateSystem:"geo",zlevel:2,silent:!0,rippleEffect:{period:4,scale:3,brushType:"stroke"},label:{normal:{show:!0,position:[24,-5],formatter:"{b}",textStyle:{fontSize:c,fontFamily:"yahei",fontWeight:100}}},symbolSize:4,itemStyle:{normal:{color:"rgb(2,255,29)",shadowBlur:35,shadowColor:"rgba(2,255,29,1)",opacity:.6}},data:a(r,n,"崇州市数据共享交换平台")}]};o.setOption(h)})}}}]),e.directive("wiservChartContract",["dashboardService",function(e){return{restrict:"ACE",template:"<div id='deptData' style='width:100%;height:100%'></div>",link:function(t,a,r){var o=echarts.init(a.find("#deptData")[0]);e.getDeptContract().then(function(e){function t(e,t,a,r){var o=[];if(r)for(var n=0,i=t.length;n<i;n++)a!=t[n].name&&o.push({coords:[e[a],e[t[n].name]]});else for(var n=0,i=t.length;n<i;n++)a!=t[n].name&&("成都医保数据"==t[n].name||"舆情数据"==t[n].name||"行政审批数据"==t[n].name?"行政审批数据"==t[n].name?o.push({coords:[e[a],e[t[n].name]],lineStyle:{normal:{curveness:.18}}}):"成都医保数据"==t[n].name?o.push({coords:[e[a],e[t[n].name]],lineStyle:{normal:{curveness:.3}}}):o.push({coords:[e[a],e[t[n].name]]}):o.push({coords:[e[t[n].name],e[a]]}));return o}function a(e,t,a){for(var r=[],o=0,n=t.length;o<n;o++){var i=t[o].name;a!=i&&("国家资源卫星数据"==i?r.push({name:i,value:e[i],symbol:"circle",symbolSize:14,label:{normal:{position:[-80,-100]}}}):"成都工商数据"==i?r.push({name:i,value:e[i],symbolSize:14,label:{normal:{align:"right",position:[-30,30],rich:{b:{align:"right"},c:{align:"right"}}}}}):"社会信用数据"==i?r.push({name:i,value:e[i],symbolSize:14,label:{normal:{align:"right",position:[-0,25]}}}):"行政审批数据"==i?r.push({name:i,value:e[i],symbolSize:14,label:{normal:{position:[-20,35]}}}):"知识产权数据"==i?r.push({name:i,value:e[i],symbolSize:14,label:{normal:{position:[40,-70]}}}):"成都医保数据"==i?r.push({name:i,value:e[i],symbolSize:14,label:{normal:{position:[25,-10]}}}):r.push({name:i,value:e[i],symbolSize:14,label:{normal:{position:[30,-30]}}}))}return r.push({name:a,value:e[a],symbol:"image://"+location.protocol+"//"+location.host+"/CZPortal/assets/images/sign.png",symbolSize:50,label:{normal:{position:[20,-80],rich:{a:{color:"#edfc02",fontSize:26}}}},itemStyle:{normal:{color:"rgb(255,234,1)"}}}),r}var r=e.data.coords,n=e.data.data,i="circle",l=.8,s=["38%","45%"],c=20,d=[60,-5],u=screen.width;screen.height;u<1600&&(l=.6,s=["29%","35%"],c=18,d=[15,-8]);var h={backgroundColor:"transparent",title:{text:"",left:"5",top:"10px",itemStyle:{normal:{borderColor:"rgba(100,149,237,1)",borderWidth:.5,areaStyle:{color:"#1b1b1b"}}}},tooltip:{trigger:"item"},geo:{map:"china",show:!1,zoom:l,layoutCenter:s,layoutSize:"100%",left:"2%",label:{emphasis:{show:!1}},roam:!0,silent:!0,itemStyle:{normal:{areaColor:"transparent",borderColor:"#000"},emphasis:{areaColor:"#2a333d"}}},series:[{type:"lines",zlevel:2,silent:!0,effect:{show:!1,period:6,trailLength:.005,color:"rgba(255,255,255,.8)",symbol:i,symbolSize:4},lineStyle:{normal:{color:"rgb(18,236,252)",width:2,opacity:1,curveness:.35,shadowColor:"rgb(18,236,252)",shadowBlur:10}},data:t(r,n,"崇州市数据共享交换平台",!1)},{type:"effectScatter",coordinateSystem:"geo",zlevel:2,silent:!0,rippleEffect:{period:10,scale:3,brushType:"stroke"},label:{normal:{show:!0,position:[24,-5],formatter:function(e){var t=e.name.split("\n");return t.length>1?t.length>2?"{a|"+t[0]+"}\n{b|"+t[1]+"}{c|"+t[2]+"}":"{a|"+t[0]+"}\n{b|"+t[1]+"}":"{a|"+t[0]+"}"},rich:{a:{color:"#3bbbf0",fontSize:26,lineHeight:40},b:{color:"#3bbbf0",fontSize:26,fontFamily:"digiFont",verticalAlign:"bottom",padding:[0,10,0,0]},c:{color:"#3bbbf0",fontSize:20,verticalAlign:"bottom"}},textStyle:{color:"#3bbbf0",fontSize:20,fontFamily:"digiFont",fontWeight:100}}},symbolSize:4,itemStyle:{normal:{color:"rgb(18,236,252)",shadowBlur:35,shadowColor:"rgba(2,255,29,1)",opacity:1}},data:a(r,n,"崇州市数据共享交换平台")}]};o.setOption(h)})}}}]),e.directive("wiservChartCar",["dashboardService","$interval",function(e,t){return{restrict:"ACE",template:"<div id='carData' style='width:100%;height:100%'></div>",link:function(a,r,o){function n(){e.getVehicleView().then(function(e){var t=e.data.body,a=_.map(t,"_id"),r=[],o=["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],n=!0;_.forEach(o,function(e,o){var i={};i.name=e;var l=_.indexOf(a,e);l>-1?(i.value=t[l].count,0!=i.value&&(n=!1)):i.value=0,r.push(i)}),console.log(r);var s={title:{text:"前一天消费趋势图（笔）",left:"3%",textStyle:{fontSize:30,fontWeight:"normal",color:"rgb(237,252,2)"}},tooltip:{trigger:"axis"},grid:{left:"3%",top:"20%",bottom:"40%",right:"35%"},xAxis:{type:"category",boundaryGap:!1,axisTick:{show:!1},axisLine:{lineStyle:{color:"rgb(8,88,123)"}},axisLabel:{textStyle:{color:"rgba(255,255,255,.6)",fontSize:22}},data:o},yAxis:{type:"value",boundaryGap:!1,axisLabel:{margin:15,textStyle:{color:"rgba(255,255,255,.6)",fontSize:22}},axisLine:{lineStyle:{color:"rgb(8,88,123)"}},splitLine:{lineStyle:{width:2,color:"rgb(8,88,123)"}}},series:[{name:"前一天消费(笔)",type:"line",stack:"总量",data:r,symbolSize:6,itemStyle:{normal:{color:"rgb(237,252,2)",shadowColor:"#FFF",shadowBlur:6}},lineStyle:{normal:{width:3,color:"rgb(237,252,2)"}}}]};l&&n||(l=!0,i.clear(),i.setOption(s))})}var i=echarts.init(r.find("#carData")[0]),l=!1;n(),t(function(){n()},864e5)}}}]),e.directive("wiservIdcUse",["dashboardService","$location",function(e,t){return{restrict:"ACE",template:"<div id='idcUse' style='width:100%;height:100%'></div>",link:function(a,r,o){var n=(t.path(),500),i=300;e.getIdcUse().then(function(e){function t(e,t){return e.map(function(e){return e[t]})}function o(e){var r=e.data.body;a.memRateList=_.map(r,"memRate"),a.cpuRateList=_.map(r,"cpuRate"),a.diskRateList=_.map(r,"diskRate");for(var o=[],n=0;n<2;n++){var i={};switch(i[""]=n.toString(),n){case 0:for(var l=0;l<r.length;l++)i[l]=r[l].memRate.toString();break;case 1:for(var l=0;l<r.length;l++)i[l]=r[l].cpuRate.toString()}o.push(i)}for(var s=[],n=0;n<9;n++)s.push(t(o,n));return s}var l=e.data.body;a.memRateList=_.map(l,"memRate"),a.cpuRateList=_.map(l,"cpuRate"),a.diskRateList=_.map(l,"diskRate"),a.nodeName=_.map(l,"nodeName");for(var s=o(e),c=[],d=0;d<s.length;d++){for(var u=[],h=0;h<s[d].length;h++){var p=a.nodeName[d]+"<br>CPU使用率: "+s[d][1]+"%<br>内存使用率: "+s[d][0]+"%";u.push(p)}c.push(u)}var p=[{z:o(e),text:c,hoverinfo:"text",type:"surface",colorbar:{tickcolor:"#e4e4e4",tickfont:{family:"微软雅黑",size:14,color:"#e4e4e4"}},scl:[["0.0","rgb(20,119,178)"],["0.222222222222","rgb(20,119,178)"],["0.555555555556","rgb(116,173,209)"],["0.777777777778","rgb(171,217,233)"],["1.0","rgb(254,224,144)"]]}];setTimeout(function(){n=.95*r.find("#idcUse")[0].clientWidth,i=r.find("#idcUse")[0].clientHeight;var e={title:"",hovermode:"closest",plot_bgcolor:"transparent",font:{family:'"Open sans", verdana, arial, sans-serif',size:16},scene:{domain:{x:[0,1],y:[0,1]},camera:{center:{x:-1,y:1.2,z:-.5},eye:{x:5.4,y:4.6,z:.4},up:{x:0,y:0,z:1}},aspectmode:"manuel",aspectratio:{x:2.8,y:11.2,z:3.6},autosize:!1,xaxis:{title:"",backgroundcolor:"transparent",gridcolor:"#e4e4e4",showbackground:!0,zerolinecolor:"#e4e4e4",tickfont:{family:"微软雅黑",size:13,color:"#e4e4e4"},ticktext:["内存使用率","CPU使用率"],tickvals:[0,.9]},yaxis:{title:"",backgroundcolor:"transparent",gridcolor:"#e4e4e4",showbackground:!0,zerolinecolor:"#e4e4e4",tickfont:{family:"微软雅黑",size:13,color:"#e4e4e4"},ticktext:a.nodeName,tickvals:[0,1,2,3,4,5,6,7,8]},zaxis:{title:"",backgroundcolor:"transparent",gridcolor:"#e4e4e4",showbackground:!0,zerolinecolor:"#e4e4e4",tickfont:{size:13,color:"#e4e4e4"},ticksuffix:"%"}},autosize:!1,width:n,height:i,margin:{l:0,r:10,b:5,t:10}};Plotly.newPlot("idcUse",p,e,{displayModeBar:!1})},2e3)})}}}]),e.directive("wiservMapText",["dashboardService",function(e){return{restrict:"ACE",template:'<canvas id="myCanvas" ></canvas>',link:function(e,t,a){function r(e,t,a,r,o,n){var i,l=t.length;e.save(),e.translate(a,r),e.rotate(-1*n/2),e.rotate(-10*(n/l));for(var s=0;s<l;s++)e.rotate(n/l),e.save(),e.translate(0,-1*o),i=t[s],e.fillText(i,0,0),e.restore();e.restore()}setTimeout(function(){var e=t.parent()[0].clientHeight,a=t.parent()[0].offsetHeight;$(t.find("canvas")).attr("width",a),$(t.find("canvas")).attr("height",a);var o=4;e>700&&(o=5);var n=document.getElementById("myCanvas"),i=n.getContext("2d"),l=n.width/2+24,s=n.height/2+16,c=Math.PI/o,d=a/2;i.font="26px Calibri",i.textAlign="center",i.fillStyle="#FFF",i.strokeStyle="transparent",i.lineWidth=0,r(i,"社会化数据",l,s,d,c),i.arc(l,s,d-10,0,2*Math.PI,!1),i.stroke()},600)}}}]),e.directive("wiservMapTextDown",["dashboardService",function(e){return{restrict:"ACE",template:'<canvas id="downCanvas" ></canvas>',link:function(e,t,a){function r(e,t,a,r,o,n,i){var l,s=t.length;e.save(),e.translate(a,r),e.rotate(-1*n/1.5),e.rotate(i*(n/s));for(var c=0;c<s;c++)e.rotate(n/s),e.save(),e.translate(0,-1*o),l=t[c],e.fillText(l,0,0),e.restore();e.restore()}setTimeout(function(){var e=t.parent()[0].clientHeight,a=t.parent()[0].offsetHeight;$(t.find("canvas")).attr("width",a),$(t.find("canvas")).attr("height",a);var o=4,n=12;e>700&&(o=6,n=19);var i=document.getElementById("downCanvas"),l=i.getContext("2d"),s=i.width/2-20,c=i.height/2-30,d=Math.PI/o,u=a/2;l.font="26px Calibri",l.textAlign="center",l.fillStyle="#FFF",l.strokeStyle="transparent",l.lineWidth=0,r(l,"政务数据",s,c,u,d,n),l.arc(s,c,u-10,0,2*Math.PI,!1),l.stroke()},600)}}}]),e.directive("wiservMapChart",[function(){return{restrict:"ACE",template:"<svg ></svg>",link:function(e,t,a){function r(e,t){var a=(e-90)/180*Math.PI,r=t;return[-r*Math.cos(a),-r*Math.sin(a)]}setTimeout(function(){var e=t.parent()[0].clientHeight,a=t.parent()[0].offsetHeight;$(t.parent()[0]).css("width",a+"px"),$(t.parent()[0]).css("height",a+"px"),$(t.find("svg")[0]).attr("width",e),$(t.find("svg")[0]).attr("height",e);var o=d3.select(t.find("svg")[0]),n=+o.attr("width"),i=+o.attr("height"),l=o.append("g").attr("transform","translate("+n/2+","+i/2+")"),s=d3.stratify().parentId(function(e){return e.id.substring(0,e.id.lastIndexOf("."))}),c=[285,150];e>700&&(c=[285,230]);var d=d3.tree().size(c).separation(function(e,t){return e.parent==t.parent,1/e.depth});d3.csv("assets/file/flare.csv",function(e,t){if(e)throw e;var a=d(s(t)),o=(l.selectAll(".link").data(a.descendants().slice(1)).enter().append("path").attr("class","link").attr("d",function(e){return"M"+r(e.x,e.y)+"C"+r(e.x,(e.y+e.parent.y)/1.8)+" "+r(e.parent.x,(e.y+e.parent.y)/3)+" "+r(e.parent.x,e.parent.y/1.1)}),l.selectAll(".node").data(a.descendants()).enter().append("g").attr("class",function(e){
return"node"+(e.children?" node--internal":" node--leaf")}).attr("transform",function(e){return e.children?"translate("+r(e.x,e.y/1.1)+")":"translate("+r(e.x,e.y)+")"}));o.append("circle").attr("r",9.5),o.append("text").attr("dy",".31em").attr("x",function(e){return e.x<180==!e.children?-12:12}).style("text-anchor",function(e){return e.x<180==!e.children?"end":"start"}).attr("transform",function(e){return"rotate("+(e.x<180?e.x-90:e.x+90)+")"}).text(function(e){return e.id.substring(e.id.lastIndexOf(".")+1)})})},600)}}}]),e.directive("wiservNestData",[function(){return{restrict:"ACE",template:"",link:function(e,t,a){}}}]),e.directive("wiservStandardSection",function(){return{restrict:"A",templateUrl:"partials/standard/view.html",replace:!0}}),e.directive("wiservCenterSection",function(){return{restrict:"A",templateUrl:"partials/center/view.html",replace:!0}}),e.directive("wiservDeptSection",function(){return{restrict:"A",templateUrl:"partials/dept/view.html",replace:!0}}),e.directive("wiservSupportSection",function(){return{restrict:"A",templateUrl:"partials/support/view.html",replace:!0}}),e.directive("wiservDatamapSection",function(){return{restrict:"A",templateUrl:"partials/datamap/view.html",replace:!0}}),e.directive("wiservIdcuseSection",function(){return{restrict:"A",templateUrl:"partials/idcuse/view.html",replace:!0}}),e.directive("wiservBigdataSection",function(){return{restrict:"A",templateUrl:"partials/bigdata/view.html",replace:!0}}),e.directive("wiservDashboard",["$location",function(e){return{restrict:"A",templateUrl:"partials/dashboard/part.html",replace:!0,link:function(t,a,r){var o=(screen.width,screen.height),n=e.path();n.indexOf("main")>-1&&$(".section").css({height:o/2+"px"})}}}]),e.directive("wiservImagePlay",["$location",function(e){return{restrict:"A",templateUrl:"partials/support/sub.html",replace:!0,link:function(e,t,a){t.slick({slidesToShow:4,slidesToScroll:1,autoplay:!0,autoplaySpeed:3e3})}}}]),e.directive("wiservImagePlaydown",["$location",function(e){return{restrict:"A",templateUrl:"partials/support/subdown.html",replace:!0,link:function(e,t,a){t.slick({slidesToShow:4,slidesToScroll:1,autoplay:!0,autoplaySpeed:3e3})}}}])}();